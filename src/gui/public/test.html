<!doctype html>
<html class="home">
<head>	
	<script src="js/jquery-1.11.3.min.js"></script>	
	<script src="js/StreamUpTeco.standalone.js"></script>
	<script type="text/javascript">


	var streamupTeco = window.StreamUpTeco;
	var level = streamupTeco.Level;
	
	var streamUp 				= streamupTeco.StreamUp,
		tripleStore 			= streamupTeco.TripleStore,
		timeSeriesStore 		= streamupTeco.TimeSeriesStore;
		Ontology				= streamupTeco.Ontology,
		Utils 					= streamupTeco.Utils;

	var sensors = [];

	$(function() {		
		var deviceId = 'myPC';
		/*var sensor = {deviceId: '123', sensorId: '456'};


		streamUp.createSensor(sensor, function(err, data) {
			if (err) {
				alert('error creating sensor: ' + err);
			} else {
				alert('create result: ' + JSON.stringify(data));
			}
		})*/		

		if (window.DeviceOrientationEvent) {
			// cretae device orientation sensor
			var sensorAlpha = {deviceId: deviceId, sensorId: 'deviceorientation-alpha'},
				sensorBeta = {deviceId: deviceId, sensorId: 'deviceorientation-beta'},
				sensorGamma = {deviceId: deviceId, sensorId: 'deviceorientation-gamma'};

			sensors.push(sensorAlpha);
			sensors.push(sensorBeta);
			sensors.push(sensorGamma);
		    window.addEventListener("deviceorientation", function(event) {		    	
		    	// insert values
		    	var now = Date.now() / 1000 | 0;
		    	streamUp.insertValues({sensor: sensorAlpha, data: [{value: event.alpha, timestamp: now}]}, function(err, result) {
		    		/*if (err) {
		    			alert('error inserting value: ' + err);
		    		} else {
		    			alert('value inserted: ' + JSON.stringify(result));
		    		}*/
		    	});
		    	streamUp.insertValues({sensor: sensorBeta, data: [{value: event.beta, timestamp: now}]});
		    	streamUp.insertValues({sensor: sensorGamma, data: [{value: event.gamma, timestamp: now}]});
		    	dataContainer.innerHTML = 'alpha: ' + event.alpha + '<br/>beta: ' + event.beta + '<br />gamma: ' + event.gamma;
		    }, true);
		}

		sensors.forEach(function(sensor) {
			streamUp.createSensor(sensor, function(err, data) {
				/*if (err) {
					alert('error creating sensor ' + JSON.stringify(sensor) + ': ' + err);
				} else {
					alert('create result for sensor ' + JSON.stringify(sensor) + ': ' + JSON.stringify(data));
				}*/
			})
		})


		/*tripleStore.insertTriple({subject: 's1', predicate: 'p1', object: 'o1'}, function() {
			tripleStore.getAllTriples(null, function(err, result) {
				alert('result: ' + JSON.stringify(result));
			})
		});*/
	});

	function getValues() {
		sensors.forEach(function(sensor) {
			streamUp.getValues({sensor: sensor}, function(err, data) {
				if (err) {
					alert('error querying sensor ' + JSON.stringify(sensor) + ': ' + err);
				} else {
					alert('values for sensor ' + JSON.stringify(sensor) + ': ' + JSON.stringify(data));
				}
			})
		})
	}
	

	</script>
</head>

<body>
 <button onclick="getValues()">Get values</button>
<div id="dataContainer"></div>
</div>


</body>
</html>
